<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stock SDK Playground</title>
  <style>
    :root {
      --bg: #0d1117;
      --surface: #161b22;
      --border: #30363d;
      --text: #c9d1d9;
      --text-muted: #8b949e;
      --accent: #58a6ff;
      --success: #3fb950;
      --error: #f85149;
      --code-bg: #0d1117;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 24px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    h1::before {
      content: 'ğŸ“ˆ';
    }

    .subtitle {
      color: var(--text-muted);
      margin-bottom: 24px;
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 16px;
    }

    .methods {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 10px;
      margin-bottom: 16px;
    }

    .method-btn {
      background: var(--bg);
      border: 1px solid var(--border);
      color: var(--text);
      text-align: left;
      padding: 12px 14px;
      font-size: 13px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .method-btn:hover {
      border-color: var(--accent);
      background: rgba(88, 166, 255, 0.1);
    }

    .method-btn.active {
      border-color: var(--accent);
      background: rgba(88, 166, 255, 0.15);
    }

    .params-section {
      display: grid;
      gap: 12px;
    }

    .param-row {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .param-label {
      min-width: 120px;
      font-size: 13px;
      color: var(--text-muted);
    }

    .param-label .required {
      color: var(--error);
      margin-left: 2px;
    }

    .param-label .optional {
      color: var(--text-muted);
      font-size: 11px;
      margin-left: 4px;
    }

    input, select {
      flex: 1;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 10px 14px;
      color: var(--text);
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s;
    }

    input:focus, select:focus {
      border-color: var(--accent);
    }

    input:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    input::placeholder {
      color: var(--text-muted);
    }

    button {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: opacity 0.2s;
      white-space: nowrap;
    }

    button:hover {
      opacity: 0.9;
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: var(--border);
    }

    .btn-group {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    .info {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
    }

    .info-item {
      font-size: 13px;
    }

    .info-label {
      color: var(--text-muted);
    }

    .info-value {
      color: var(--accent);
      font-weight: 500;
    }

    .code-example {
      margin-bottom: 16px;
    }

    .code-toggle {
      display: flex;
      align-items: center;
      gap: 8px;
      background: none;
      border: none;
      color: var(--accent);
      font-size: 13px;
      padding: 8px 0;
      cursor: pointer;
    }

    .code-toggle:hover {
      opacity: 0.8;
    }

    .code-toggle svg {
      transition: transform 0.2s;
    }

    .code-toggle.expanded svg {
      transform: rotate(90deg);
    }

    .code-content {
      display: none;
      background: var(--code-bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 16px;
      margin-top: 8px;
      font-family: 'SF Mono', Monaco, 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.6;
      white-space: pre-wrap;
      overflow-x: auto;
    }

    .code-content.show {
      display: block;
    }

    .code-content .keyword {
      color: #ff7b72;
    }

    .code-content .string {
      color: #a5d6ff;
    }

    .code-content .comment {
      color: #8b949e;
    }

    .code-content .function {
      color: #d2a8ff;
    }

    .result {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 16px;
      font-family: 'SF Mono', Monaco, 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.6;
      max-height: 500px;
      overflow: auto;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .result.error {
      border-color: var(--error);
      color: var(--error);
    }

    .result.success {
      border-color: var(--success);
    }

    .status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }

    .status.loading {
      background: rgba(88, 166, 255, 0.15);
      color: var(--accent);
    }

    .status.success {
      background: rgba(63, 185, 80, 0.15);
      color: var(--success);
    }

    .status.error {
      background: rgba(248, 81, 73, 0.15);
      color: var(--error);
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .spinner {
      width: 14px;
      height: 14px;
      border: 2px solid var(--accent);
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Stock SDK Playground</h1>
    <p class="subtitle">æœ¬åœ°è°ƒè¯•å·¥å…· - ç›´æ¥æµ‹è¯• SDK å„ç§æ–¹æ³•</p>

    <div class="card">
      <div class="card-title">é€‰æ‹© API æ–¹æ³•</div>
      <div class="methods" id="methods"></div>
    </div>

    <div class="card">
      <div class="card-title">è¯·æ±‚å‚æ•°</div>
      <div class="params-section" id="params-section"></div>
      <div class="btn-group">
        <button id="fetch-btn" onclick="fetchData()">å‘é€è¯·æ±‚</button>
        <button class="btn-secondary" onclick="clearResult()">æ¸…ç©º</button>
      </div>
      <div class="info" id="info" style="display: none;">
        <div class="info-item">
          <span class="info-label">å½“å‰æ–¹æ³•ï¼š</span>
          <span class="info-value" id="current-method">getFullQuotes</span>
        </div>
        <div class="info-item" id="status-container" style="display: none;">
          <span class="status" id="status"></span>
        </div>
        <div class="info-item" id="time-container" style="display: none;">
          <span class="info-label">è€—æ—¶ï¼š</span>
          <span class="info-value" id="time"></span>
        </div>
        <div class="info-item" id="count-container" style="display: none;">
          <span class="info-label">è¿”å›æ•°é‡ï¼š</span>
          <span class="info-value" id="count"></span>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">è¿”å›ç»“æœ</div>
      <div class="code-example">
        <button class="code-toggle" id="code-toggle" onclick="toggleCode()">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path>
          </svg>
          æŸ¥çœ‹ä»£ç ç¤ºä¾‹
        </button>
        <div class="code-content" id="code-content"></div>
      </div>
      <div class="result" id="result">ç‚¹å‡»"å‘é€è¯·æ±‚"æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
    </div>
  </div>

  <script type="module">
    import { StockSDK } from '../dist/index.js';

    const sdk = new StockSDK();
    window.sdk = sdk;

    // è·å–é»˜è®¤æ—¥æœŸèŒƒå›´ï¼ˆè¿‘30å¤©ï¼‰
    function getDefaultDateRange() {
      const end = new Date();
      const start = new Date();
      start.setDate(start.getDate() - 30);
      
      const format = (d) => {
        const year = d.getFullYear();
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const day = String(d.getDate()).padStart(2, '0');
        return `${year}${month}${day}`;
      };
      
      return { startDate: format(start), endDate: format(end) };
    }
    
    const defaultDates = getDefaultDateRange();

    // æ–¹æ³•é…ç½®
    const methodsConfig = {
      getFullQuotes: {
        name: 'getFullQuotes',
        desc: 'è·å– A è‚¡/æŒ‡æ•°å…¨é‡è¡Œæƒ…',
        params: [
          { key: 'codes', label: 'è‚¡ç¥¨ä»£ç ', type: 'text', default: 'sz000858,sh600519', required: true, placeholder: 'å¤šä¸ªç”¨é€—å·åˆ†éš”ï¼Œå¦‚ sz000858,sh600519' }
        ],
        code: `<span class="keyword">const</span> quotes = <span class="keyword">await</span> sdk.<span class="function">getFullQuotes</span>([<span class="string">'sz000858'</span>, <span class="string">'sh600519'</span>]);
<span class="comment">// è¿”å›: FullQuote[]</span>
console.log(quotes[0].name);   <span class="comment">// äº” ç²® æ¶²</span>
console.log(quotes[0].price);  <span class="comment">// 111.70</span>`
      },
      getSimpleQuotes: {
        name: 'getSimpleQuotes',
        desc: 'è·å–ç®€è¦è¡Œæƒ…',
        params: [
          { key: 'codes', label: 'è‚¡ç¥¨ä»£ç ', type: 'text', default: 'sz000858,sh000001', required: true, placeholder: 'å¤šä¸ªç”¨é€—å·åˆ†éš”' }
        ],
        code: `<span class="keyword">const</span> quotes = <span class="keyword">await</span> sdk.<span class="function">getSimpleQuotes</span>([<span class="string">'sz000858'</span>, <span class="string">'sh000001'</span>]);
<span class="comment">// è¿”å›: SimpleQuote[]</span>
console.log(quotes[0].name);  <span class="comment">// äº” ç²® æ¶²</span>`
      },
      getAShareCodeList: {
        name: 'getAShareCodeList',
        desc: 'è·å–å…¨éƒ¨ A è‚¡ä»£ç åˆ—è¡¨',
        params: [
          { key: 'includeExchange', label: 'åŒ…å«äº¤æ˜“æ‰€å‰ç¼€', type: 'select', default: 'true', required: false, options: [{ value: 'true', label: 'æ˜¯' }, { value: 'false', label: 'å¦' }] }
        ],
        code: `<span class="comment">// åŒ…å«äº¤æ˜“æ‰€å‰ç¼€ï¼ˆé»˜è®¤ï¼‰</span>
<span class="keyword">const</span> codes = <span class="keyword">await</span> sdk.<span class="function">getAShareCodeList</span>();
console.log(codes[0]);  <span class="comment">// 'bj920000'</span>

<span class="comment">// ä¸åŒ…å«äº¤æ˜“æ‰€å‰ç¼€</span>
<span class="keyword">const</span> pureCodes = <span class="keyword">await</span> sdk.<span class="function">getAShareCodeList</span>(<span class="keyword">false</span>);
console.log(pureCodes[0]);  <span class="comment">// '920000'</span>`
      },
      getUSCodeList: {
        name: 'getUSCodeList',
        desc: 'è·å–å…¨éƒ¨ç¾è‚¡ä»£ç åˆ—è¡¨',
        params: [
          { key: 'includeMarket', label: 'åŒ…å«å¸‚åœºå‰ç¼€', type: 'select', default: 'true', required: false, options: [{ value: 'true', label: 'æ˜¯' }, { value: 'false', label: 'å¦' }] }
        ],
        code: `<span class="comment">// åŒ…å«å¸‚åœºå‰ç¼€ï¼ˆé»˜è®¤ï¼‰</span>
<span class="keyword">const</span> codes = <span class="keyword">await</span> sdk.<span class="function">getUSCodeList</span>();
console.log(codes[0]);  <span class="comment">// '105.MSFT'</span>

<span class="comment">// ä¸åŒ…å«å¸‚åœºå‰ç¼€</span>
<span class="keyword">const</span> pureCodes = <span class="keyword">await</span> sdk.<span class="function">getUSCodeList</span>(<span class="keyword">false</span>);
console.log(pureCodes[0]);  <span class="comment">// 'MSFT'</span>`
      },
      getHKCodeList: {
        name: 'getHKCodeList',
        desc: 'è·å–å…¨éƒ¨æ¸¯è‚¡ä»£ç åˆ—è¡¨',
        params: [],
        code: `<span class="keyword">const</span> codes = <span class="keyword">await</span> sdk.<span class="function">getHKCodeList</span>();
console.log(codes[0]);  <span class="comment">// '00700'</span>`
      },
      getAllAShareQuotes: {
        name: 'getAllAShareQuotes',
        desc: 'è·å–å…¨éƒ¨ A è‚¡å®æ—¶è¡Œæƒ…',
        params: [
          { key: 'batchSize', label: 'æ‰¹é‡å¤§å°', type: 'number', default: '500', required: false, placeholder: 'é»˜è®¤ 500' },
          { key: 'concurrency', label: 'å¹¶å‘æ•°', type: 'number', default: '7', required: false, placeholder: 'é»˜è®¤ 7' }
        ],
        code: `<span class="keyword">const</span> allQuotes = <span class="keyword">await</span> sdk.<span class="function">getAllAShareQuotes</span>({
  batchSize: <span class="string">500</span>,
  concurrency: <span class="string">7</span>,
  onProgress: (completed, total) => {
    console.log(<span class="string">\`è¿›åº¦: \${completed}/\${total}\`</span>);
  }
});
console.log(<span class="string">\`å…±è·å– \${allQuotes.length} åªè‚¡ç¥¨\`</span>);`
      },
      getAllHKShareQuotes: {
        name: 'getAllHKShareQuotes',
        desc: 'è·å–å…¨éƒ¨æ¸¯è‚¡å®æ—¶è¡Œæƒ…',
        params: [
          { key: 'batchSize', label: 'æ‰¹é‡å¤§å°', type: 'number', default: '500', required: false, placeholder: 'é»˜è®¤ 500' },
          { key: 'concurrency', label: 'å¹¶å‘æ•°', type: 'number', default: '7', required: false, placeholder: 'é»˜è®¤ 7' }
        ],
        code: `<span class="keyword">const</span> allQuotes = <span class="keyword">await</span> sdk.<span class="function">getAllHKShareQuotes</span>({
  batchSize: <span class="string">500</span>,
  concurrency: <span class="string">7</span>,
  onProgress: (completed, total) => {
    console.log(<span class="string">\`è¿›åº¦: \${completed}/\${total}\`</span>);
  }
});
console.log(<span class="string">\`å…±è·å– \${allQuotes.length} åªæ¸¯è‚¡\`</span>);`
      },
      getAllUSShareQuotes: {
        name: 'getAllUSShareQuotes',
        desc: 'è·å–å…¨éƒ¨ç¾è‚¡å®æ—¶è¡Œæƒ…',
        params: [
          { key: 'batchSize', label: 'æ‰¹é‡å¤§å°', type: 'number', default: '500', required: false, placeholder: 'é»˜è®¤ 500' },
          { key: 'concurrency', label: 'å¹¶å‘æ•°', type: 'number', default: '7', required: false, placeholder: 'é»˜è®¤ 7' }
        ],
        code: `<span class="keyword">const</span> allQuotes = <span class="keyword">await</span> sdk.<span class="function">getAllUSShareQuotes</span>({
  batchSize: <span class="string">500</span>,
  concurrency: <span class="string">7</span>,
  onProgress: (completed, total) => {
    console.log(<span class="string">\`è¿›åº¦: \${completed}/\${total}\`</span>);
  }
});
console.log(<span class="string">\`å…±è·å– \${allQuotes.length} åªç¾è‚¡\`</span>);`
      },
      getFundFlow: {
        name: 'getFundFlow',
        desc: 'è·å–èµ„é‡‘æµå‘',
        params: [
          { key: 'codes', label: 'è‚¡ç¥¨ä»£ç ', type: 'text', default: 'sz000858', required: true, placeholder: 'å¤šä¸ªç”¨é€—å·åˆ†éš”' }
        ],
        code: `<span class="keyword">const</span> flows = <span class="keyword">await</span> sdk.<span class="function">getFundFlow</span>([<span class="string">'sz000858'</span>]);
<span class="comment">// è¿”å›: FundFlow[]</span>
console.log(flows[0].mainNet);  <span class="comment">// ä¸»åŠ›å‡€æµå…¥</span>`
      },
      getPanelLargeOrder: {
        name: 'getPanelLargeOrder',
        desc: 'è·å–ç›˜å£å¤§å•å æ¯”',
        params: [
          { key: 'codes', label: 'è‚¡ç¥¨ä»£ç ', type: 'text', default: 'sz000858', required: true, placeholder: 'å¤šä¸ªç”¨é€—å·åˆ†éš”' }
        ],
        code: `<span class="keyword">const</span> orders = <span class="keyword">await</span> sdk.<span class="function">getPanelLargeOrder</span>([<span class="string">'sz000858'</span>]);
<span class="comment">// è¿”å›: PanelLargeOrder[]</span>
console.log(orders[0].buyLargeRatio);  <span class="comment">// ä¹°ç›˜å¤§å•å æ¯”</span>`
      },
      getHKQuotes: {
        name: 'getHKQuotes',
        desc: 'è·å–æ¸¯è‚¡æ‰©å±•è¡Œæƒ…',
        params: [
          { key: 'codes', label: 'æ¸¯è‚¡ä»£ç ', type: 'text', default: '09988', required: true, placeholder: 'å¦‚ 09988, 00700' }
        ],
        code: `<span class="keyword">const</span> quotes = <span class="keyword">await</span> sdk.<span class="function">getHKQuotes</span>([<span class="string">'09988'</span>]);
<span class="comment">// è¿”å›: HKQuote[]</span>
console.log(quotes[0].name);  <span class="comment">// é˜¿é‡Œå·´å·´-W</span>`
      },
      getUSQuotes: {
        name: 'getUSQuotes',
        desc: 'è·å–ç¾è‚¡ç®€è¦è¡Œæƒ…',
        params: [
          { key: 'codes', label: 'ç¾è‚¡ä»£ç ', type: 'text', default: 'BABA', required: true, placeholder: 'å¦‚ BABA, AAPL' }
        ],
        code: `<span class="keyword">const</span> quotes = <span class="keyword">await</span> sdk.<span class="function">getUSQuotes</span>([<span class="string">'BABA'</span>]);
<span class="comment">// è¿”å›: USQuote[]</span>
console.log(quotes[0].code);  <span class="comment">// BABA.N</span>`
      },
      getFundQuotes: {
        name: 'getFundQuotes',
        desc: 'è·å–å…¬å‹ŸåŸºé‡‘è¡Œæƒ…',
        params: [
          { key: 'codes', label: 'åŸºé‡‘ä»£ç ', type: 'text', default: '000001', required: true, placeholder: 'å¦‚ 000001, 110011' }
        ],
        code: `<span class="keyword">const</span> funds = <span class="keyword">await</span> sdk.<span class="function">getFundQuotes</span>([<span class="string">'000001'</span>]);
<span class="comment">// è¿”å›: FundQuote[]</span>
console.log(funds[0].name);  <span class="comment">// åå¤æˆé•¿æ··åˆ</span>
console.log(funds[0].nav);   <span class="comment">// æœ€æ–°å‡€å€¼</span>`
      },
      getHistoryKline: {
        name: 'getHistoryKline',
        desc: 'è·å– A è‚¡å†å² K çº¿ï¼ˆæ—¥/å‘¨/æœˆï¼‰',
        params: [
          { key: 'symbol', label: 'è‚¡ç¥¨ä»£ç ', type: 'text', default: 'sz000001', required: true, placeholder: 'å¦‚ sz000001 æˆ– 000001' },
          { key: 'period', label: 'Kçº¿å‘¨æœŸ', type: 'select', default: 'daily', required: false, options: [{ value: 'daily', label: 'æ—¥çº¿' }, { value: 'weekly', label: 'å‘¨çº¿' }, { value: 'monthly', label: 'æœˆçº¿' }] },
          { key: 'adjust', label: 'å¤æƒç±»å‹', type: 'select', default: 'hfq', required: false, options: [{ value: '', label: 'ä¸å¤æƒ' }, { value: 'qfq', label: 'å‰å¤æƒ' }, { value: 'hfq', label: 'åå¤æƒ' }] },
          { key: 'startDate', label: 'å¼€å§‹æ—¥æœŸ', type: 'text', get default() { return defaultDates.startDate; }, required: false, placeholder: 'YYYYMMDDï¼Œå¦‚ 20240101' },
          { key: 'endDate', label: 'ç»“æŸæ—¥æœŸ', type: 'text', get default() { return defaultDates.endDate; }, required: false, placeholder: 'YYYYMMDDï¼Œå¦‚ 20241231' }
        ],
        code: `<span class="comment">// è·å–æ—¥çº¿ï¼ˆé»˜è®¤åå¤æƒï¼‰</span>
<span class="keyword">const</span> klines = <span class="keyword">await</span> sdk.<span class="function">getHistoryKline</span>(<span class="string">'sz000001'</span>);

<span class="comment">// è·å–å‘¨çº¿ï¼Œå‰å¤æƒï¼ŒæŒ‡å®šæ—¥æœŸèŒƒå›´</span>
<span class="keyword">const</span> weeklyKlines = <span class="keyword">await</span> sdk.<span class="function">getHistoryKline</span>(<span class="string">'sz000858'</span>, {
  period: <span class="string">'weekly'</span>,
  adjust: <span class="string">'qfq'</span>,
  startDate: <span class="string">'20240101'</span>,
  endDate: <span class="string">'20241231'</span>
});
console.log(klines[0].date);   <span class="comment">// '2024-12-17'</span>
console.log(klines[0].close);  <span class="comment">// æ”¶ç›˜ä»·</span>`
      },
      getHKHistoryKline: {
        name: 'getHKHistoryKline',
        desc: 'è·å–æ¸¯è‚¡å†å² K çº¿ï¼ˆæ—¥/å‘¨/æœˆï¼‰',
        params: [
          { key: 'symbol', label: 'æ¸¯è‚¡ä»£ç ', type: 'text', default: '00700', required: true, placeholder: 'å¦‚ 00700ï¼ˆè…¾è®¯ï¼‰ã€09988ï¼ˆé˜¿é‡Œï¼‰' },
          { key: 'period', label: 'Kçº¿å‘¨æœŸ', type: 'select', default: 'daily', required: false, options: [{ value: 'daily', label: 'æ—¥çº¿' }, { value: 'weekly', label: 'å‘¨çº¿' }, { value: 'monthly', label: 'æœˆçº¿' }] },
          { key: 'adjust', label: 'å¤æƒç±»å‹', type: 'select', default: 'hfq', required: false, options: [{ value: '', label: 'ä¸å¤æƒ' }, { value: 'qfq', label: 'å‰å¤æƒ' }, { value: 'hfq', label: 'åå¤æƒ' }] },
          { key: 'startDate', label: 'å¼€å§‹æ—¥æœŸ', type: 'text', get default() { return defaultDates.startDate; }, required: false, placeholder: 'YYYYMMDDï¼Œå¦‚ 20240101' },
          { key: 'endDate', label: 'ç»“æŸæ—¥æœŸ', type: 'text', get default() { return defaultDates.endDate; }, required: false, placeholder: 'YYYYMMDDï¼Œå¦‚ 20241231' }
        ],
        code: `<span class="comment">// è·å–è…¾è®¯æ§è‚¡æ—¥ K çº¿ï¼ˆé»˜è®¤åå¤æƒï¼‰</span>
<span class="keyword">const</span> klines = <span class="keyword">await</span> sdk.<span class="function">getHKHistoryKline</span>(<span class="string">'00700'</span>);

<span class="comment">// è·å–é˜¿é‡Œå·´å·´å‘¨ K çº¿ï¼Œå‰å¤æƒ</span>
<span class="keyword">const</span> weeklyKlines = <span class="keyword">await</span> sdk.<span class="function">getHKHistoryKline</span>(<span class="string">'09988'</span>, {
  period: <span class="string">'weekly'</span>,
  adjust: <span class="string">'qfq'</span>,
  startDate: <span class="string">'20240101'</span>,
  endDate: <span class="string">'20241231'</span>
});
console.log(klines[0].name);   <span class="comment">// 'è…¾è®¯æ§è‚¡'</span>
console.log(klines[0].close);  <span class="comment">// æ”¶ç›˜ä»·</span>`
      },
      getUSHistoryKline: {
        name: 'getUSHistoryKline',
        desc: 'è·å–ç¾è‚¡å†å² K çº¿ï¼ˆæ—¥/å‘¨/æœˆï¼‰',
        params: [
          { key: 'symbol', label: 'ç¾è‚¡ä»£ç ', type: 'text', default: '105.MSFT', required: true, placeholder: 'å¦‚ 105.MSFTï¼ˆå¾®è½¯ï¼‰ã€106.BABAï¼ˆé˜¿é‡Œï¼‰' },
          { key: 'period', label: 'Kçº¿å‘¨æœŸ', type: 'select', default: 'daily', required: false, options: [{ value: 'daily', label: 'æ—¥çº¿' }, { value: 'weekly', label: 'å‘¨çº¿' }, { value: 'monthly', label: 'æœˆçº¿' }] },
          { key: 'adjust', label: 'å¤æƒç±»å‹', type: 'select', default: 'hfq', required: false, options: [{ value: '', label: 'ä¸å¤æƒ' }, { value: 'qfq', label: 'å‰å¤æƒ' }, { value: 'hfq', label: 'åå¤æƒ' }] },
          { key: 'startDate', label: 'å¼€å§‹æ—¥æœŸ', type: 'text', get default() { return defaultDates.startDate; }, required: false, placeholder: 'YYYYMMDDï¼Œå¦‚ 20240101' },
          { key: 'endDate', label: 'ç»“æŸæ—¥æœŸ', type: 'text', get default() { return defaultDates.endDate; }, required: false, placeholder: 'YYYYMMDDï¼Œå¦‚ 20241231' }
        ],
        code: `<span class="comment">// è·å–å¾®è½¯æ—¥ K çº¿ï¼ˆé»˜è®¤åå¤æƒï¼‰</span>
<span class="keyword">const</span> klines = <span class="keyword">await</span> sdk.<span class="function">getUSHistoryKline</span>(<span class="string">'105.MSFT'</span>);

<span class="comment">// è·å–è‹¹æœå‘¨ K çº¿ï¼Œå‰å¤æƒ</span>
<span class="keyword">const</span> weeklyKlines = <span class="keyword">await</span> sdk.<span class="function">getUSHistoryKline</span>(<span class="string">'105.AAPL'</span>, {
  period: <span class="string">'weekly'</span>,
  adjust: <span class="string">'qfq'</span>,
  startDate: <span class="string">'20240101'</span>,
  endDate: <span class="string">'20241231'</span>
});

<span class="comment">// å¸‚åœºä»£ç : 105(çº³æ–¯è¾¾å…‹), 106(çº½äº¤æ‰€)</span>
console.log(klines[0].name);   <span class="comment">// 'å¾®è½¯'</span>
console.log(klines[0].close);  <span class="comment">// æ”¶ç›˜ä»·</span>`
      },
      getMinuteKline: {
        name: 'getMinuteKline',
        desc: 'è·å– A è‚¡åˆ†é’Ÿ K çº¿/åˆ†æ—¶',
        params: [
          { key: 'symbol', label: 'è‚¡ç¥¨ä»£ç ', type: 'text', default: 'sz000001', required: true, placeholder: 'å¦‚ sz000001 æˆ– 000001' },
          { key: 'period', label: 'Kçº¿å‘¨æœŸ', type: 'select', default: '1', required: false, options: [{ value: '1', label: '1åˆ†é’Ÿ(åˆ†æ—¶)' }, { value: '5', label: '5åˆ†é’Ÿ' }, { value: '15', label: '15åˆ†é’Ÿ' }, { value: '30', label: '30åˆ†é’Ÿ' }, { value: '60', label: '60åˆ†é’Ÿ' }] },
          { key: 'adjust', label: 'å¤æƒç±»å‹', type: 'select', default: 'hfq', required: false, options: [{ value: '', label: 'ä¸å¤æƒ' }, { value: 'qfq', label: 'å‰å¤æƒ' }, { value: 'hfq', label: 'åå¤æƒ' }] }
        ],
        code: `<span class="comment">// è·å–åˆ†æ—¶æ•°æ®ï¼ˆè¿‘ 5 ä¸ªäº¤æ˜“æ—¥ï¼‰</span>
<span class="keyword">const</span> timeline = <span class="keyword">await</span> sdk.<span class="function">getMinuteKline</span>(<span class="string">'sz000001'</span>);

<span class="comment">// è·å– 5 åˆ†é’Ÿ K çº¿</span>
<span class="keyword">const</span> kline5m = <span class="keyword">await</span> sdk.<span class="function">getMinuteKline</span>(<span class="string">'sz000858'</span>, {
  period: <span class="string">'5'</span>,
  adjust: <span class="string">'hfq'</span>
});
console.log(timeline[0].time);      <span class="comment">// '2024-12-17 09:30'</span>
console.log(timeline[0].avgPrice);  <span class="comment">// å‡ä»·</span>`
      },
      getTodayTimeline: {
        name: 'getTodayTimeline',
        desc: 'è·å–å½“æ—¥åˆ†æ—¶èµ°åŠ¿',
        params: [
          { key: 'code', label: 'è‚¡ç¥¨ä»£ç ', type: 'text', default: 'sz000001', required: true, placeholder: 'å¦‚ sz000001' }
        ],
        code: `<span class="keyword">const</span> timeline = <span class="keyword">await</span> sdk.<span class="function">getTodayTimeline</span>(<span class="string">'sz000001'</span>);
<span class="comment">// è¿”å›: TodayTimelineResponse</span>
console.log(timeline.date);         <span class="comment">// '20241217'</span>
console.log(timeline.data.length);  <span class="comment">// 240</span>

<span class="keyword">const</span> first = timeline.data[0];
console.log(first.time);      <span class="comment">// '09:30'</span>
console.log(first.price);     <span class="comment">// 11.47ï¼ˆæˆäº¤ä»·ï¼‰</span>
console.log(first.avgPrice);  <span class="comment">// 11.47ï¼ˆå‡ä»· = ç´¯è®¡æˆäº¤é¢ / ç´¯è®¡æˆäº¤é‡Ã—100ï¼‰</span>
console.log(first.volume);    <span class="comment">// ç´¯è®¡æˆäº¤é‡ï¼ˆè‚¡ï¼‰</span>`
      },
      getKlineWithIndicators: {
        name: 'getKlineWithIndicators',
        desc: 'è·å–å¸¦æŠ€æœ¯æŒ‡æ ‡çš„ K çº¿',
        params: [
          { key: 'symbol', label: 'è‚¡ç¥¨ä»£ç ', type: 'text', default: 'sz000001', required: true, placeholder: 'æ”¯æŒ Aè‚¡/æ¸¯è‚¡/ç¾è‚¡ï¼Œå¦‚ sz000001ã€00700ã€105.MSFT' },
          { key: 'period', label: 'Kçº¿å‘¨æœŸ', type: 'select', default: 'daily', required: false, options: [{ value: 'daily', label: 'æ—¥çº¿' }, { value: 'weekly', label: 'å‘¨çº¿' }, { value: 'monthly', label: 'æœˆçº¿' }] },
          { key: 'adjust', label: 'å¤æƒç±»å‹', type: 'select', default: 'hfq', required: false, options: [{ value: '', label: 'ä¸å¤æƒ' }, { value: 'qfq', label: 'å‰å¤æƒ' }, { value: 'hfq', label: 'åå¤æƒ' }] },
          { key: 'startDate', label: 'å¼€å§‹æ—¥æœŸ', type: 'text', get default() { return defaultDates.startDate; }, required: false, placeholder: 'YYYYMMDDï¼Œå¦‚ 20240101' },
          { key: 'endDate', label: 'ç»“æŸæ—¥æœŸ', type: 'text', get default() { return defaultDates.endDate; }, required: false, placeholder: 'YYYYMMDDï¼Œå¦‚ 20241231' },
          { key: 'indicators', label: 'æŠ€æœ¯æŒ‡æ ‡', type: 'text', default: 'ma,macd,boll,kdj,rsi,wr,bias,cci,atr', required: false, placeholder: 'å¯é€‰: ma,macd,boll,kdj,rsi,wr,bias,cci,atr' }
        ],
        code: `<span class="comment">// è·å–å¸¦æŠ€æœ¯æŒ‡æ ‡çš„æ—¥ K çº¿</span>
<span class="keyword">const</span> data = <span class="keyword">await</span> sdk.<span class="function">getKlineWithIndicators</span>(<span class="string">'sz000001'</span>, {
  startDate: <span class="string">'20240101'</span>,
  endDate: <span class="string">'20241231'</span>,
  indicators: {
    ma: { periods: [<span class="string">5</span>, <span class="string">10</span>, <span class="string">20</span>, <span class="string">60</span>] },
    macd: <span class="keyword">true</span>,
    boll: <span class="keyword">true</span>,
    kdj: <span class="keyword">true</span>,
    rsi: { periods: [<span class="string">6</span>, <span class="string">12</span>] },
    wr: <span class="keyword">true</span>
  }
});

<span class="comment">// ä½¿ç”¨æ•°æ®</span>
data.forEach(k => {
  console.log(k.date, k.close);
  console.log(<span class="string">'MA5='</span>, k.ma?.ma5);
  console.log(<span class="string">'MACD:'</span>, k.macd?.dif, k.macd?.dea);
  console.log(<span class="string">'BOLL:'</span>, k.boll?.upper, k.boll?.mid, k.boll?.lower);
  console.log(<span class="string">'KDJ:'</span>, k.kdj?.k, k.kdj?.d, k.kdj?.j);
});

<span class="comment">// æ¸¯è‚¡ï¼ˆè‡ªåŠ¨è¯†åˆ«ï¼‰</span>
<span class="keyword">const</span> hkData = <span class="keyword">await</span> sdk.<span class="function">getKlineWithIndicators</span>(<span class="string">'00700'</span>, {
  indicators: { ma: <span class="keyword">true</span>, macd: <span class="keyword">true</span> }
});

<span class="comment">// ç¾è‚¡ï¼ˆè‡ªåŠ¨è¯†åˆ«ï¼‰</span>
<span class="keyword">const</span> usData = <span class="keyword">await</span> sdk.<span class="function">getKlineWithIndicators</span>(<span class="string">'105.MSFT'</span>, {
  indicators: { boll: <span class="keyword">true</span>, rsi: <span class="keyword">true</span> }
});`
      }
    };

    let currentMethod = 'getFullQuotes';

    // æ¸²æŸ“æ–¹æ³•æŒ‰é’®
    function renderMethods() {
      const container = document.getElementById('methods');
      container.innerHTML = Object.keys(methodsConfig).map(key => {
        const method = methodsConfig[key];
        return `<button class="method-btn ${key === currentMethod ? 'active' : ''}" data-method="${key}">${method.name}</button>`;
      }).join('');

      container.querySelectorAll('.method-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.method-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          currentMethod = btn.dataset.method;
          renderParams();
          updateCodeExample();
          document.getElementById('current-method').textContent = currentMethod;
        });
      });
    }

    // æ¸²æŸ“å‚æ•°è¡¨å•
    function renderParams() {
      const method = methodsConfig[currentMethod];
      const container = document.getElementById('params-section');
      
      container.innerHTML = method.params.map(param => {
        let input;
        if (param.type === 'select') {
          input = `<select id="param-${param.key}">
            ${param.options.map(opt => `<option value="${opt.value}" ${opt.value === param.default ? 'selected' : ''}>${opt.label}</option>`).join('')}
          </select>`;
        } else {
          input = `<input type="${param.type}" id="param-${param.key}" value="${param.default}" placeholder="${param.placeholder || ''}">`;
        }
        
        return `<div class="param-row">
          <label class="param-label">
            ${param.label}
            ${param.required ? '<span class="required">*</span>' : '<span class="optional">(å¯é€‰)</span>'}
          </label>
          ${input}
        </div>`;
      }).join('');
    }

    // æ›´æ–°ä»£ç ç¤ºä¾‹
    function updateCodeExample() {
      const method = methodsConfig[currentMethod];
      document.getElementById('code-content').innerHTML = method.code;
    }

    // åˆ‡æ¢ä»£ç ç¤ºä¾‹æ˜¾ç¤º
    window.toggleCode = function() {
      const toggle = document.getElementById('code-toggle');
      const content = document.getElementById('code-content');
      toggle.classList.toggle('expanded');
      content.classList.toggle('show');
    };

    // è·å–å‚æ•°å€¼
    function getParamValues() {
      const method = methodsConfig[currentMethod];
      const values = {};
      method.params.forEach(param => {
        const el = document.getElementById(`param-${param.key}`);
        if (el) {
          values[param.key] = el.value;
        }
      });
      return values;
    }

    // å‘é€è¯·æ±‚
    window.fetchData = async function() {
      const params = getParamValues();
      const resultEl = document.getElementById('result');
      const infoEl = document.getElementById('info');
      const statusContainer = document.getElementById('status-container');
      const statusEl = document.getElementById('status');
      const timeContainer = document.getElementById('time-container');
      const timeEl = document.getElementById('time');
      const countContainer = document.getElementById('count-container');
      const countEl = document.getElementById('count');
      const fetchBtn = document.getElementById('fetch-btn');

      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      fetchBtn.disabled = true;
      infoEl.style.display = 'flex';
      statusContainer.style.display = 'block';
      statusEl.className = 'status loading';
      statusEl.innerHTML = '<div class="spinner"></div> è¯·æ±‚ä¸­...';
      timeContainer.style.display = 'none';
      countContainer.style.display = 'none';
      resultEl.textContent = 'åŠ è½½ä¸­...';
      resultEl.className = 'result';

      const startTime = performance.now();

      try {
        let result;

        switch (currentMethod) {
          case 'getFullQuotes': {
            const codes = params.codes.split(',').map(c => c.trim()).filter(Boolean);
            result = await sdk.getFullQuotes(codes);
            break;
          }
          case 'getSimpleQuotes': {
            const codes = params.codes.split(',').map(c => c.trim()).filter(Boolean);
            result = await sdk.getSimpleQuotes(codes);
            break;
          }
          case 'getAShareCodeList': {
            result = await sdk.getAShareCodeList(params.includeExchange === 'true');
            break;
          }
          case 'getUSCodeList': {
            result = await sdk.getUSCodeList(params.includeMarket === 'true');
            break;
          }
          case 'getHKCodeList': {
            result = await sdk.getHKCodeList();
            break;
          }
          case 'getAllAShareQuotes': {
            result = await sdk.getAllAShareQuotes({
              batchSize: parseInt(params.batchSize) || 500,
              concurrency: parseInt(params.concurrency) || 7,
              onProgress: (completed, total) => {
                resultEl.textContent = `åŠ è½½ä¸­... ${completed}/${total} æ‰¹æ¬¡`;
              }
            });
            break;
          }
          case 'getAllHKShareQuotes': {
            result = await sdk.getAllHKShareQuotes({
              batchSize: parseInt(params.batchSize) || 500,
              concurrency: parseInt(params.concurrency) || 7,
              onProgress: (completed, total) => {
                resultEl.textContent = `åŠ è½½ä¸­... ${completed}/${total} æ‰¹æ¬¡`;
              }
            });
            break;
          }
          case 'getAllUSShareQuotes': {
            result = await sdk.getAllUSShareQuotes({
              batchSize: parseInt(params.batchSize) || 500,
              concurrency: parseInt(params.concurrency) || 7,
              onProgress: (completed, total) => {
                resultEl.textContent = `åŠ è½½ä¸­... ${completed}/${total} æ‰¹æ¬¡`;
              }
            });
            break;
          }
          case 'getFundFlow': {
            const codes = params.codes.split(',').map(c => c.trim()).filter(Boolean);
            result = await sdk.getFundFlow(codes);
            break;
          }
          case 'getPanelLargeOrder': {
            const codes = params.codes.split(',').map(c => c.trim()).filter(Boolean);
            result = await sdk.getPanelLargeOrder(codes);
            break;
          }
          case 'getHKQuotes': {
            const codes = params.codes.split(',').map(c => c.trim()).filter(Boolean);
            result = await sdk.getHKQuotes(codes);
            break;
          }
          case 'getUSQuotes': {
            const codes = params.codes.split(',').map(c => c.trim()).filter(Boolean);
            result = await sdk.getUSQuotes(codes);
            break;
          }
          case 'getFundQuotes': {
            const codes = params.codes.split(',').map(c => c.trim()).filter(Boolean);
            result = await sdk.getFundQuotes(codes);
            break;
          }
          case 'getHistoryKline': {
            const options = { period: params.period, adjust: params.adjust };
            if (params.startDate) options.startDate = params.startDate;
            if (params.endDate) options.endDate = params.endDate;
            result = await sdk.getHistoryKline(params.symbol, options);
            break;
          }
          case 'getHKHistoryKline': {
            const options = { period: params.period, adjust: params.adjust };
            if (params.startDate) options.startDate = params.startDate;
            if (params.endDate) options.endDate = params.endDate;
            result = await sdk.getHKHistoryKline(params.symbol, options);
            break;
          }
          case 'getUSHistoryKline': {
            const options = { period: params.period, adjust: params.adjust };
            if (params.startDate) options.startDate = params.startDate;
            if (params.endDate) options.endDate = params.endDate;
            result = await sdk.getUSHistoryKline(params.symbol, options);
            break;
          }
          case 'getMinuteKline': {
            result = await sdk.getMinuteKline(params.symbol, {
              period: params.period,
              adjust: params.adjust
            });
            break;
          }
          case 'getTodayTimeline': {
            result = await sdk.getTodayTimeline(params.code);
            break;
          }
          case 'getKlineWithIndicators': {
            const options = { period: params.period, adjust: params.adjust };
            if (params.startDate) options.startDate = params.startDate;
            if (params.endDate) options.endDate = params.endDate;
            // è§£ææŒ‡æ ‡é…ç½®
            const indicatorList = params.indicators ? params.indicators.split(',').map(s => s.trim()).filter(Boolean) : [];
            options.indicators = {};
            indicatorList.forEach(ind => {
              if (ind === 'ma') options.indicators.ma = { periods: [5, 10, 20, 60] };
              else if (ind === 'macd') options.indicators.macd = true;
              else if (ind === 'boll') options.indicators.boll = true;
              else if (ind === 'kdj') options.indicators.kdj = true;
              else if (ind === 'rsi') options.indicators.rsi = { periods: [6, 12, 24] };
              else if (ind === 'wr') options.indicators.wr = true;
              else if (ind === 'bias') options.indicators.bias = { periods: [6, 12, 24] };
              else if (ind === 'cci') options.indicators.cci = true;
              else if (ind === 'atr') options.indicators.atr = true;
            });
            result = await sdk.getKlineWithIndicators(params.symbol, options);
            break;
          }
          default:
            throw new Error('æœªçŸ¥æ–¹æ³•');
        }

        const endTime = performance.now();
        const duration = (endTime - startTime).toFixed(0);

        statusEl.className = 'status success';
        statusEl.textContent = 'âœ“ æˆåŠŸ';
        timeContainer.style.display = 'block';
        timeEl.textContent = `${duration}ms`;
        countContainer.style.display = 'block';
        countEl.textContent = Array.isArray(result) ? result.length : (result?.data?.length || 1);

        resultEl.textContent = JSON.stringify(result, null, 2);
        resultEl.className = 'result success';

      } catch (error) {
        const endTime = performance.now();
        const duration = (endTime - startTime).toFixed(0);

        statusEl.className = 'status error';
        statusEl.textContent = 'âœ• å¤±è´¥';
        timeContainer.style.display = 'block';
        timeEl.textContent = `${duration}ms`;

        resultEl.textContent = `é”™è¯¯: ${error.message}\n\n${error.stack || ''}`;
        resultEl.className = 'result error';
      } finally {
        fetchBtn.disabled = false;
      }
    };

    // æ¸…ç©ºç»“æœ
    window.clearResult = function() {
      document.getElementById('result').textContent = 'ç‚¹å‡»"å‘é€è¯·æ±‚"æŒ‰é’®å¼€å§‹æµ‹è¯•...';
      document.getElementById('result').className = 'result';
      document.getElementById('info').style.display = 'none';
    };

    // åˆå§‹åŒ–
    renderMethods();
    renderParams();
    updateCodeExample();

    console.log('ğŸš€ Stock SDK Playground å·²åŠ è½½');
    console.log('ğŸ’¡ æç¤º: å¯ä»¥åœ¨æ§åˆ¶å°ä½¿ç”¨ window.sdk ç›´æ¥è°ƒç”¨ SDK æ–¹æ³•');
  </script>
</body>
</html>
